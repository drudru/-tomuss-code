<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta charset="utf-8">
    <title>Documentation TOMUSS (The Online Multi User SpreadSheet)</title>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <link rel="stylesheet" href="documentation.css" type="text/css">
  </head>
  
  <body>
    <div class="top">
      
      <div>
	<h1>Documentation <a href="http://perso.univ-lyon1.fr/thierry.excoffier/TOMUSS/home.html">TOMUSS</a></h1>
	<h1><small>The Online Multi User Simple Spreadsheet</small></h1>
	<p>
	  Cet outil permet de saisir des notes concernant
	  une UE de manière collaborative sur le web.
	<p>
	  Il s'utilise à partir d'un navigateur web récent,
	  dans l'ordre de préférence&nbsp;:
	  google-chrome, firefox, internet explorer, opera...
	  Si cela ne fonctionne pas, si cela bloque
	  ou si c'est lent (plus de 5 secondes de chargement)
	  alors regardez dans la documentation pour trouver
	  comment <a href="javascript:go('problèmes d\'affichage')">résoudre le problème</a>.
	<p><b>
	  Vous avez trouvé un bug, vous avez besoin d'aide
	  ou bien vous désirez une nouvelle fonctionnalité
	  alors <a href="mailto:_ADMIN_">demandez à l'administrateur</a></b>.
	<p>
	  Les
	  <a href="http://perso.univ-lyon1.fr/thierry.excoffier/TOMUSS/TUTORIALS/">«comment faire pour» en video
	    </a>
    </div>

    <div>
    <h2>La page d'accueil</h2>
      <p>
	  Elle vous permet de <b>choisir une UE</b> parmi celles présentées,
	  ou bien de chercher une UE en tapant quelques lettres
	  de son code APOGÉE, de son titre ou du nom de
	  l'un des responsables de l'UE.
    </div>

    <div>
    <h3>Choix du semestre</h3>
      <p>
	  Tous les liens affichés sur la page d'accueil s'appliquent
	  au <b>semestre choisi dans le menu déroulant</b> en haut de la page.
	<p>
	  Les UE des semestres passés ne sont plus éditables
	  sauf dans le cas d'une 
	  <a href="javascript:go('UE à cheval sur 2 semestres')">UE à cheval sur 2 semestres</a>.

    </div>
    <div>
    <h3>Suivi des étudiants</h3>
    <p>
      Toutes les personnes qui peuvent saisir des notes
      ont une vue de la totalité
      des informations saisies pour un étudiant.
      Que cela soit les notes ou les commentaires associés.
    <p>
      Il suffit de cliquer sur le lien «Suivi des étudiants»
      puis de taper le numéro d'étudiant dans la case de gauche.
      Si on ne le connait pas, il faut alors taper son nom ou son
      prénom complet dans la case de droite.
      Si vous êtes dans une table, il suffit de cliquer
      sur la photo de l'étudiant.
    <p>
      Quelque soit l'adresse TOMUSS utilisée par les étudiants,
      ceux-ci ne verront que leurs notes personnelles.
    <p>
      Pour cacher (masquer) une colonne aux étudiants il faut
      indiquer la date à laquelle la colonne doit leur être affichée.
      À cette date, leur note pour cette colonne deviendra visible.
    <p>
      Les étudiants peuvent voir leur classement et les statistiques
      pour chacune des notes.
      Les enseignants peuvent voir le rang de l'étudiant dans une
      UE pour toutes les colonnes
      en mettant le curseur sur la photo de l'étudiant
      quand il sont en train d'éditer l'UE en question.
    </div>

    <div>
    <h3>Gestion des ABJ, DA et TT</h3>
     <p>
      Les <b>absences justifiées, les dispenses d'assiduité
      et les tiers temps</b> sont saisis par
      l'administration dans TOMUSS et sont affichés quand
      on édite les tables.
     <p>
      Cette documentation contient
      <a href="javascript:go('Gestion des absences justifiées')">quelques conseils sur la manière de gérer les ABJ</a>.
    </div>
    
    <div>
    <h4>Divers</h4>
     <p>
       L'<b>emplois du temps</b> (planning ADEweb) d'une UE est disponible
       sur la page d'accueil en cliquant sur le
       <span style="background:#8F8">+</span> ou bien dans 
       dans l'onglet «Infos» du bloc de droite de l'éditeur de table.
     <p>
       Pour <b>devenir référent d'un étudiant</b> : il faut le chercher
       sur la page d'accueil puis cliquer sur le
       <span style="background:#8F8">+</span>
       et choisir dans le menu :
       «Je veux être référent pédagogique de cet étudiant»
    </div>

    <div>
    <h2>Les bases de l'édition de table</h2>
      <p>
	  Dès que la table apparaît vous pouvez travailler dessus.
	  Si une nouvelle note est saisie par quelqu'un d'autre,
	  elle sera directement affichée sur votre écran.
      <p>
	  Pour modifier une cellule, vous <b>cliquez dessus et
	    modifiez sa valeur</b> (si vous avez le droit).
	  Pour mémoriser la valeur vous changez de cellule
	  en utilisant une touche du clavier ou bien en cliquant
	  ailleurs.
	  Pour annuller une saisie en cours, appuyez sur
	  la touche échappement.
    </div>

    <div>
    <h3>Naviguer dans la table</h3>
      <p>
	La <b>table sur l'écran est une partie d'une grande table</b>.
	Pour se déplacer dans la grande table il suffit de cliquer
	sur une cellule et d'utiliser les touches clavier&nbsp;:
	<ul>
	  <li> «page suivante» pour aller en bas.</li>
	  <li> «page précédente» pour aller en haut.</li>
	  <li> «tab» ou «curseur droit» pour aller à droite.</li>
	  <li> «majuscule tab» ou «curseur gauche» pour aller à gauche.</li>
	</ul>
      <p>
	Vous pouvez aussi utilisez les barres d'ascenseur
	ou la molette de la souris.
      <p>
	Pour trouver rapidement un étudiant,
	il faut taper le début de son nom, prénom ou identifiant dans le
	<a href="javascript:go_hash('filtres')">filtre de ligne</a>.
	Seule les lignes dans lesquelles l'une des cases contient
	la valeur recherchée seront affichées.
	Le filtre de ligne est la case affichée en jaune quand
	vous arrivez sur la table.
	Pour y retourner, vous pouvez cliquer dessus ou taper&nbsp;:
	<tt>Ctrl-f</tt>
    </div>
    <div>
    <h3>Modification des cellules</h3>
      <p>
	Chaque fois que vous modifiez quelque chose la <b>modification
	est automatiquement sauvegardée</b> sans que vous ayez
	besoin de le demander.
	Un carré vert apparaît si la sauvegarde a réussi.
      <p>
	<b>Tout enseignant peut ajouter des notes et des commentaires
	dans n'importe quelle UE</b>.
      <p>
	Seul un <b>enseignant responsable de l'UE</b> (la liste est indiquée
	dans SPIRAL) peut modifier les notes saisies par les
	autres enseignants.
	Il peut ajouter d'autres responsables d'UE.
      <p>
	Si plusieurs enseignants travaillent sur le même tableau,
	les <b>modifications apportées par l'un seront instantanément
	visibles par les autres</b>.
      <p>
	Il est possible que des <b>carrés oranges</b> apparaissent,
	cela indique que les valeurs n'ont pas été sauvegardées
	à cause d'un problème réseau ou sur le serveur.
	Elles passeront au vert une fois le problème résolu.
	Il est déconseillé de saisir de nombreuses notes
	dans ces conditions car si vous fermez votre navigateur
	tout est perdu.
	Cela peut se produire s'il y a trop de fenêtres ouvertes.
	<p>
	  Les valeurs possibles pour une cellule dépendent
	  du type de la colonne.
    <ul>
      <li><p> Le contenu d'une cellule de type 'Prst' (présent)
	peut être&nbsp;:
	<ul>
	  <li> <tt>PRST</tt> : L'étudiant était présent.
	  Vous pouvez taper <tt>P</tt> au lieu de <tt>PRST</tt></li>
	  <li> <tt>ABINJ</tt> : ABsence INJustifiée.
	  Vous pouvez taper <tt>I</tt> au lieu de <tt>ABINJ</tt></li>
	  <li> <tt>ABJUS</tt> : ABsence JUStifiée.
	  Vous pouvez taper <tt>J</tt> au lieu de <tt>ABJUS</tt></li>
	</ul>
	En double cliquant sur la cellule vous la basculez d'une
	valeur à une autre.
      </li>
      <li><p> Le contenu d'une cellule de type 'Note' peut être&nbsp;:
	<ul>
	  <li> <tt>ABINJ</tt> : ABsence INJustifiée (donc 0).</li>
	  <li> <tt>ABJUS</tt> : ABsence JUStifiée
	    (ne compte pas dans les moyennes).</li>
	  <li> <tt>PPN</tT> : ne Peux Pas Noter
	    (ne compte pas dans les moyennes).
	  Vous pouvez taper <tt>N</tt> au lieu de <tt>PPN</tt></li>
	  <li> <tt>TNR</tT> : Travail Non Rendu (donc 0).
	</li>
	</ul>
      <li><p> Le contenu d'une cellule de type calcul peut
	  être <b>NaN</b> quand des cases nécessaires au calcul
	  on été laissées vides.
      </li>
       <li> Le type de colonne <tt>URL</tt> permet de diffuser
	  un lien cliquable aux étudiants.
	 Il est paramétrable dans l'onglet «Config» avec
	  <ul>
	    <li>
	      Le titre du lien si vous ne voulez pas de <em>Cliquez ici</em>
	    <li>
	      Si <b>toutes</b> les URL de la colonne commencent
	      par la même suite de caractères,
	      on peut factoriser cette suite de caractères en l'indiquant
	      dans le champs URL.
	    <li>
	      Il est possible de choisir case par case le titre du lien
	      en l'indiquant après l'url dans la cellule, par exemple :<br>
	      <tt>http://tomuss.univ-lyon1.fr Page d'accueil TOMUSS</tt>
	  </ul>
	</li>
    </ul>
    </div>
    <div>
    <h3>Couleurs</h3>
      <p>
	  Les <b>lignes sur fond rouge</b> indiquent que l'étudiant
	  n'est pas <em>actuellement</em> inscrit à l'UE.</p>
      <p>
	  Les <b>lignes sur fond bleu</b> indiquent que l'étudiant
	  dispose d'un tiers temps.</p>
      <p>
	  Les textes en gras ont été modifié aujourd'hui.
      <p>
	  Les textes noirs sont ceux que vous avez saisi
	  et les gris ceux que les autres ont saisi.
    </div>
    <div>
    <a name="emargement"> </a>
    <h3>Feuilles d'émargement</h3>
      <p>
	  On obtient les feuilles d'émargement en cliquant
	  sur «Imprimer». Puis en cliquant sur le lien :
	  «Je veux une feuille d'émargement».
	  Les feuilles d'émargement contiennent :
	<ul>
	  <li> Les étudiants filtrées,
	    il faut donc penser à enlever les filtres si l'on
	    veut tous les étudiants.
	  <li> Seulement les étudiants officiellement inscrits.
	  <li> La dernière page liste l'ensemble des tiers-temps
	    <b>si vous avez cliqué sur le bouton les demandant</b>
	</ul>
	<p>
	  Les feuilles d'émargement peuvent être adaptées
	  de plusieurs manières&nbsp;:
	<ul>
	  <li> Pour avoir une feuille par groupe : vous cliquez
	    sur «Je veux un feuille par groupe».
	  <li> Pour ajouter une colonne contenant des
	    <a href="javascript:go('Placer les étudiants dans un Amphi')">
	      numéros de place</a>
	    pour les étudiants, il suffit de cliquer
	    sur le nom de la colonne contenant les numéros de place
	    afin de les afficher.
	  <li> Pour avoir une feuille par salle,
	    il faut demander à grouper par salle et non par groupe d'étudiant.
	  <li> On peut afficher ou non la liste des tiers-temps.
	</ul>
    </div>
    <div>
    <h3>Problèmes d'affichage</h3>
	<p>
	  En cas de problème réactualisez la page,
	<p>
	  Si vous avez bien le réseau sur votre machine mais que les
	  sauvegardes ne se font pas (les carrés oranges restent)&nbsp;:
	  fermez les autres fenêtres TOMUSS, en effet certains
	  navigateurs web limitent le nombre de pages affichées
	  sur le même site à quelques-unes seulement.
	<p>
	  Si les pages sont longues à charger (plus de 4 secondes)
	  ou bien si elles n'apparaissent pas.
	<ul>
	  <li> Vous avez un anti-virus : dites-lui que <tt>tomuss.univ-lyon1.fr</tt>
	    est un site de confiance.
	  <li> Vous êtes sous Safari : réactualisez la page.
	</ul>
	  
    </div>
	
    <div>
    <h2>Les colonnes</h2>
    <ul>
      <li><p>
	Pour <b>changer ajouter/créer une colonne</b>,
	vous donnez simplement un titre à une colonne inutilisée.
      <li><p>
	Pour <b>changer le titre d'une colonne</b>,
	vous cliquez sur une cellule de la colonne dans le tableau,
	puis vous cliquez sur le titre de la colonne juste au dessous
	de l'onglet «Colonne».
	Vous pouvez alors taper son nouveau nom.
	Le nom ne doit pas contenir d'espace et il ne doit
	pas y avoir deux noms identiques.
      <li><p>
	Pour <b>inserrer une colonne entre deux colonnes</b>,
	vous créez une nouvelle colonne à droite puis vous la décalez à gauche
	en allant dans l'onglet «Colonne / Affiche»
        puis en cliquant sur <img src="prev.gif" alt="la flèche gauche">
	jusqu'à la position désirée.
      <li><p>
	Pour <b>trier les lignes</b> en fonction du contenu d'une colonne
	il suffit de cliquer sur le triangle dans titre de la colonne.
      </li>
      <li><p>
	Si l'on veut <b>trier en fonction de plusieurs colonnes</b>
	(en cas d'égalité) il suffit de cliquer sur les triangles
	dans le bon ordre.
      </li>
      <li><p>
	Pour <b>changer l'ordre de tri</b> il faut cliquer à nouveau
	sur le triangle.
      </li>
	  <li><p> On peut associer un <b>commentaire</b> à la colonne
	      pour expliquer plus précisemment son titre ou donner
	      des informations complémentaires aux étudiants.
	      Ce commentaire apparaît dans une bulle d'aide.
	      <p>
	      Il y a aussi un commentaire de tableau
	      pour afficher un message aux étudiants
	      de l'UE dans leur suivi.
	      Ce commentaire est affiché à coté du titre
	      de l'UE.
	  </li>
	    
      <li><p>
	  Le <b>filtre en haut de chaque colonne permet de n'afficher que certaines lignes</b> du tableau.
	  Sa définition dépend du contenu de la colonne.
	  Mettez le curseur sur le filtre pour savoir ce que
	  vous pouvez indiquer.
	<p>
	  La plupart des actions que l'on peut faire sur une table
	  portent sur les lignes filtrées.
	  Si vous voulez travailler sur l'ensemble de la table
	  n'oubliez pas d'enlever tous les filtres.
	<p>
	  Pour n'afficher que les lignes rouges (pas inscrits officiellement),
	  indiquez «<b>@=</b>» comme filtre dans la colonne «ID»
	  ou bien «<b>!@=</b>» pour ne pas les voir.
      </li>	 
      <li>
	Au dessus du tableau, le champ 'filtre' de colonne permet de n'afficher
	que les colonnes dont le nom commence par le texte
	que vous avez entré.
      </li>
    </ul>
    </div>

    <div>
    <h3>Faire un questionnaire</h3>
    <p>
      Le questionnaire s'adresse aux étudiants,
      il s'intègre naturellement au suivi de l'étudiant,
      au lieu d'avoir une note, l'étudiant dispose d'un champ de saisi.
    <p>
      Les enseignants peuvent répondre à la place de l'étudiants,
      et bien sûr on ne peut pas modifier une valeur saisie par
      quelqu'un d'autre.
    <p>
      Il faut donc une colonne par question :
      <ul>
	<li><p> Indiquez le type de la colonne afin de définir les réponses
	  possibles pour l'étudiant.
	  Si c'est une énumération ou un booléen,
	  l'étudiant aura un menu déroulant avec les choix possibles.
	<li><p> Dans l'onglet «Colonne / Config» indiquez que
	  «Les étudiants peuvent modifier leur valeur à partir du suivi»
      </ul>
    <p>
      Si la MÊME réponse à la question ne peut être données qu'un nombre
      limité de fois (choix de projet, de créneau de rendez vous...)
      alors vous indiquez le nombre limite dans le champs
      «Répétition» de l'onglet «Colonne / Formule»

    </div>

    <div>
    <h3>Dépôt de document</h3>
    <p style="background:#F00;color:#FFF">
      Fonctionnalité expérimentale sans garanties.
      Ne pas utiliser pour le moment.
    <p>
      Pour créer un zone de dépôt pour les étudiants :
      <ul>
	<li> Vous mettez le type de colonne «Dépôt»
	<li> Vous pouvez indiquer à la droite du type la taille
	  maximum autorisée pour le fichier déposé en kilo octets.
	<li> Pour que les étudiants puissent déposer :
	  il faut dans l'onglet «Config» basculer de
	  «Personne ne peux modifier à partir du suivi»
	  à «Les étudiants peuvent modifier leur valeur à partir du suivi»
      </ul>
    <p>
      Quelques remarques :
      <ul>
	<li> On ne peut déposer qu'un seul document par cellule.
	<li> La valeur de la cellule est la taille en Ko du document.
	<li> Le commentaire de la cellule contient le type mime du fichier
	  ainsi que son nom original sur le disque du déposant.
	<li> Les enseignants peuvent déposer à la place des étudiants.
	<li> Les étudiants peuvent charger ce qu'ils ont déposé.
	<li> On ne peut pas effacer de fichier.
	<li> Les fichiers déposés sont détruits à la fin du semestre.
	<li> Il n'y a pas d'anti-plagiat.
	<li> Dans la tableau, si l'on double clic sur la cellule
	  cela charge le document déposé.
	<li> si des groupes d'étudiants sont utilisés,
	  Les autres membres du groupe peuvent voir ce qui a été déposé.
	  Il y a un commentaire sur la cellule de celui qui a fait le dépôt.
      </ul>
      Si vous ne changez pas le comportement par défaut, alors :
      <ul>
	<li> Il n'y a pas de date limite de dépôt.
	<li> Les étudiants peuvent remplacer le fichier déposé.
	  Les anciens fichiers déposés sont écrasés.
	<li> Si des groupes d'étudiants sont utilisés, celui qui a déposé
	  est le seul à pouvoir modifier.
      </ul>
      <p>Droits de déposer.
	<p>
	    Le droit de dépôt est défini par le champ «Cellule modifiable si»
	    qui est dans l'onglet «Config».
	    Essayez de faire le plus simple possible car il est facile
	    de se tromper.
	    <br>
	    Voici quelques filtres que l'on va utiliser pour gérer cela,
	    vous pouvez les tester en coloriant les cellules.
	    <ul>
	      <li> «=» tout seul indique que la cellule est vide
		et donc qu'il n'y a pas de dépôt.
	      <li> «@» tout seul indique que c'est l'étudiant qui a fait
		le précédent dépôt (donc ni son binôme ni le prof)
	      <li> «?[]» est la date actuelle.
	      <li> «?» est la date de modification de la cellule.
	      <li> «@[]» est le login de la personne qui regarde/modifie.
	    </ul>
	    <table>
	      <tr><td> <td style="text-align:center">
		  <b>«Cellule modifiable si»</b><br>
		    Le «<b>ou</b>» fait parti du filtre.
	      </tr>
	      <tr>
		<td> Donner 6 minutes aux étudiants pour redéposer
		  s'ils se sont trompés.
		  <td> = <b>ou</b> @ ?&lt;0.1h
	      </tr>
	      <tr>
		<td> Autoriser des étudiants à redéposer une fois.<br>
		  Mettre OK dans les cellules des étudiants en question.
		  <td> =OK
	      </tr>
	      <tr>
		<td>Interdire la modification après le premier dépôt.<br>
		<td> =
	      </tr>
	      <tr>
		<td> Autoriser 1 ou 2 étudiants déposer.<br>
		  <td style="white-space:nowrap"> @[]=p0000000 <b>ou</b> @[]=p1234567
	      </tr>
	      <tr>
		<td> Autoriser une séquence à déposer.
		  <td> [Seq]=1 = <b>ou</b> [Seq]=1 @
	      </tr>
	      <tr>
		<td> Indiquer une date limite de dépôt.
		  <td style="white-space:nowrap"> = ?[]&lt;30/1/2015-15:00:00
	      </tr>
	      <tr>
		<td> Date limite + séquence + redépôt autorisé
		  <td>
		    ?[]&lt;30/1/2015 [Seq]=1 =<br> <b>ou</b> ?[]&lt;30/1/2015 [Seq]=1 @
	      </tr>
	      <tr>
		<td> Date limite + séquence + redépôt autorisé,
		  autorise les étudiants à écraser ce que
		  l'enseignant ou le binôme a saisi.<br>
		  <b>Autorise tous les enseignants à écraser
		    la cellule</b>
		  <td>
		    ?[]&lt;30/1/2015 [Seq]=1
	      </tr>
	      <tr>
		<td> Idem avec plusieurs séquences et groupes et
		  des dates de début.
		  <td>
		    ?[]&gt;30/1/2015-09:00 ?[]&lt;30/1/2015-10:00 [Seq]=1<br>
		    <b>ou</b> ?[]&gt;31/1/2015-10:00 ?[]&lt;31/1/2015-11:00 [Seq]=2<br>
	      </tr>
	    </table>
      <p>Astuces d'utilisation :
      <ul>
	<li> <b>Trier par date de dépôt ou les afficher.</b><br>
	  Vous mettez le curseur sur «▼» et vous cliquez sur «Date»
	<li> <b>Colorier en rouge les dépôts après la date limite.</b><br>
	  Dans l'onglet «Affiche» vous mettez «?&gt;20/07/2015-14:00:00» dans
	  le champ «Rougir»
	<li> <b>Colorier en vert les dépôts PDF</b><br>
	  Dans l'onglet «Affiche» vous mettez «#application/pdf» dans
	  le champ «Verdir»
	<li> <b>Envoyer un message à ceux qui n'ont pas déposé le document.</b><br>
	  Vous mettez «=» dans le filtre de la colonne de dépôt
	  et vous cliquez sur le bouton «Mail»
	<li> <b>Récupérer un fichier ZIP des documents des étudiants
	    pour son groupe de TD.</b><br>
	  Vous filtrez vos étudiants et vous cliquez sur «Charger ZIP»
	  L'extraction du ZIP créera un répertoire «CodeUE_TitreColonne»
	  contenant un fichier par étudiant «N°étu_prénom_nom_fichier»

	<li> <b>Stocker des fichiers dans chaque cellule de la colonne</b><br>
	  Vous créez un fichier ZIP dont les noms des fichiers à l'intérieur
	  sont de la forme <b>dossier/p1234567#nom_fichier</b>.
	  Vous cliquez sur «Import ZIP» pour enregistrer tous ces fichiers
	  dans la colonne.
	  La partie «nom_fichier» sera affichée aux étudiants.
	  <br>
	  <b>Pour que les étudiants puissent modifier votre fichier</b>,
	  il faut leur donner le droit de modifier la cellule que
	  vous avez saisi.
	  Pour ce faire,
	  dans l'onglet «Config» vous mettez «@votre.login ou @»
	  dans le champ «Cellule modifiable si».
	  Cela les autorise à déposer si c'est vous qui avez modifié
	  la cellule ou bien s'ils veulent déposer une nouvelle version.
	  Il faut compléter avec «ou =» si vous voulez les autoriser
	  à déposer dans les cases vides.
      </ul>
    </div>

    <div>
    <h3>Deuxième session</h3>
    <p>
      Si remplacer la note de première session par celle de deuxième
      session en mettant un commentaire ne vous convient pas,
      alors la manière la plus simple est la suivante :
    </p>
    <ul>
      <li> Vous créez une colonne contenant uniquement
	la note de deuxième session.
      <li> Vous créez une nouvelle colonne moyenne calculant
	la moyenne en utilisant la note de deuxième session.
      <li> Vous effacez les NaN en utilisant la fonctionnalité de
	<a href="#remplir">remplissage de colonne</a>.
    </ul>
    </div>

    <div>
    <a name="toc-average"> </a>
    <h2>Calcul de moyenne</h2>
    <p>
      L'utilisation classique est très simple :
    </p>
    <ul>
      <li> Vous cliquez sur l'onglet «Formule».
      <li> vous mettez des poids corrects aux colonnes
      <li> vous ajoutez une colonne de type <tt>Moyenne</tt>
	(il faut cliquer sur «Note» dans une colonne vide)
	en écrivant dans le champ «Colonnes » de l'onglet «Formule» la liste
	des noms des colonnes sur lesquelles calculer la moyenne pondérée.
    </ul>
    <p>
      Les étapes du calcul qui sont faites automatiquement par TOMUSS&nbsp;:
    <ul>
      <li> Normaliser les notes entre 0 et 1.
      <li> Calculer la moyenne pondérées des notes.
      <li> Dénormaliser en utilisant la valeur indiquée dans
	l'intervalle de valeurs possibles pour cette colonne.
	Si c'est <tt>[0;20]</tt> alors les moyennes calculées seront
	entre 0 et 20.
    </ul>
    <p>
      Gestion des cas particuliers&nbsp;:
    <ul>
	<li> <tt>ABINJ</tt> compte comme la note minimale autorisée.
	<li> <tt>ABJUS</tt> ne compte pas dans la moyenne.
	S'il n'y a que des <tt>ABINJ</tt> alors le résultat est
	<tt>ABINJ</tt>.
	S'il n'y a que des <tt>ABJUS</tt> alors le résultat est
	<tt>ABJUS</tt>.
	<li> <tt>PPN</tt> ne compte pas dans la moyenne.
	S'il n'y a que des <tt>PPN</tt> et des  <tt>ABJUS</tt>
	alors le résultat est <tt>PPN</tt>.
    </ul>
    </div>

    <div>
    <h3>Addition et soustraction</h3>
    <p>
      Pour faire des additions et soustractions (points jury
	  ou bonus par exemple)
      il faut indiquer des poids particuliers pour les colonnes.
    <ul>
      <li> Si le poids d'une colonne commence par le
	signe '<tt>+</tt>' alors le poids de cette
	colonne n'est pas ajouté aux autres quand
	on calcule la moyenne pondérée, mais il est utilisé
	comme facteur multiplicatif.
	Ceci permet de faire une addition et non une moyenne.
      <li> Si le poids d'une colonne est négatif.
	Alors la valeur est soustraite au lieu d'être ajoutée.
	le poids de cette colonne n'est pas ajouté aux autres quand
	on calcule la moyenne pondérée, mais il est utilisé
	comme facteur multiplicatif.
      <li> Si le poids est nul, la colonne ne compte pas.
    </ul>
    <p>Par exemple pour calculer la moyenne de 2 notes et ajouter un bonus :
      </p>
    <ul>
      <li> TP1 : poids 1 </li>
      <li> TP2 : poids 1 </li>
      <li> Bonus : poids <b>+</b>1 </li>
      <li> Moyenne de <b>TP1 TP2 Bonus</b> :
	la moyenne de TP1 et TP2 est calculée et les valeurs de la colonne
	Bonus sont ajoutés avec une simple addition.
	</li>
    </ul>
	    
    <p>
      Évidemment <tt>ABJ + 1</tt> affichera <tt>ABJ</tt>.
      De même  <tt>ABI + 1</tt> donne <tt>ABI</tt>.
    </p>
    <p>
      Le rang et la moyenne ne sont pas affichées dans la page étudiant
      pour ces colonnes bonus/malus.
      </p>
    </div>
    <div>

    <h4>Malus de 0.5 point par absence injustifiée</h4>
	<p>
	  Vous faites une colonne pour compter le nombre d'absence
	  injustifiées. C'est le type de colonne : «Nombre de»
	<p>
	  Il y a alors une nouvelle case contenant «!ABINJ»
	  qui indique ce qu'il faut compter.
	  Il faut mettre «ABINJ» car c'est ce que l'on veut compter.
	<p>
	  Vous indiquez dans la zone au dessous de «ABINJ» la liste
	  des noms de colonnes dans lesquelles vous voulez compter
	  le nombre d'absences.
	  Comme pour la moyenne, vous séparez les noms de colonne
	  par un espace.
	<p>
	  Vous mettez ensuite un poids de «-0.5» à cette colonne qui
	  compte le nombre d'absences injustifiées afin d'enlever
	  0.5 point par absence.
	<p>
	  Vous ajoutez cette colonne dans la liste des colonnes qui
	  permettent de calculer la moyenne finale de l'UE.
	<p>
	  Vous vérifiez à la main sur un étudiant pour voir
	  si le calcul est exact...

   </div>
   <div>   
    <h3>Moyennes de moyennes</h3>

	<p>
	  Faire un moyenne de moyenne ne donne pas le même résultat
	  qu'une moyenne simple, en effet :
<tt>Moyenne(a<sub>1</sub>,b<sub>1</sub>,c<sub>1</sub>,d<sub>1</sub>)</tt>
      est différente de
      <tt>Moyenne(Moyenne(a<sub>1</sub>,b<sub>1</sub>,c<sub>1</sub>)<sub>3</sub>,d<sub>1</sub>)</tt>
    <p>
      Les chiffres en indice sont les poids des colonnes dans
      la moyenne pondérée.
    <p>
      Si <tt>a</tt>, <tt>b</tt>, <tt>c</tt> et <tt>d</tt> sont quatre notes
      alors pas de problème les deux formules donnent le même résultat.
      Par contre si <tt>a=ABJ</tt> c'est une autre histoire.
    <p>
      <tt>Moyenne(ABJ<sub>1</sub>,b<sub>1</sub>,c<sub>1</sub>,d<sub>1</sub>)</tt>
      donne <tt>Moyenne(b<sub>1</sub>,c<sub>1</sub>,d<sub>1</sub>)</tt> car
      l'ABJ ne compte pas dans la moyenne.
      Les trois notes restantes comptent autant les unes que les autres.
    <p>
      <tt>Moyenne(Moyenne(ABJ<sub>1</sub>,b<sub>1</sub>,c<sub>1</sub>)<sub>3</sub>,d<sub>1</sub>)</tt> donne
      <tt>Moyenne(Moyenne(b<sub>1</sub>,c<sub>1</sub>)<sub>3</sub>,d<sub>1</sub>)</tt>
      qui est égale à
      <tt>Moyenne(b<sub>1.5</sub>,c<sub>1.5</sub>,d<sub>1</sub>)</tt>
    <p>
      Le choix de l'une ou de l'autre des méthodes de calcul
      dépend des modalités de contrôle de connaissance de l'UE.
      La méthode la plus juste est de faire une moyenne simple.
      
    </div>
    <div>
    <h3>Moyenne en enlevant des notes</h3>
    <p>
      TOMUSS trie les notes de la plus mauvaise à la meilleure
      et peut enlever les plus mauvaises et les meilleures notes.
      Vous indiquez dans l'onglet «formule» le nombre
      de mauvaises et de bonnes notes à enlever.
    <p>
      Si on veut prendre seulement la meilleure note
      il faut choisir le type de colonne <b>Maximum</b>
      au lieu de moyenne.
    <p>
      ATTENTION : le système refusera de calculer
      si l'une des cellules est invalide ou bien si l'étudiant
      a trop de ABJ.
      Par exemple vous enlevez 2 notes à {5,ABJ,ABI},
      il ne reste que ABJ qui n'est pas calculable.
    <p>
      ATTENTION : Si les poids des colonnes ne sont pas égaux,
      le résultat du calcul n'est pas forcément égal
      à la moyenne maximum possible.
      Il est même possible que le résultat soit différent d'une
      évaluation sur l'autre.
    </div>
    <div>
    <h2>Gestion des absences justifiées (ABJ)</h2>

    <p>
      Les absences justifiées sont saisies au
      niveau des secrétariats qui les enregistrent dans TOMUSS
      dès qu'elles sont reçues.
    <p>
      Pour intégrer ces informations dans les tableaux de note
      il y a plusieurs méthode&nbsp;:
    <ul>
      <li> La plus simple est d'associer une liste de demi-journées
	d'enseignement à une colonne dans le champs «Dates» de
	l'onglet «Config»,
	si vous saisissez un ABINJ alors que l'étudiant a un justificatif
	pour l'une des demi-journée alors le ABINJ est affiché en rouge.
      </li>
      <li> Vous pouvez aussi faire une gestion ``au fil de l'eau´´&nbsp;:
	Vous saisissez les présences et absences moins
	d'une semaine après le TP/TD en question.
	Si jamais un étudiant a un justificatif d'absence
	qui correspond à une semaine près à la date de saisie de l'ABINJ
	alors le mot ABINJ sera souligné dans le tableau.
      </li>
      <li> Si vous n'avez pas fait cela, alors
	vous triez colonne par colonne pour regrouper
	tous les ABINJ ensemble puis vous parcourez rapidement
	avec la touche curseur vers le bas les étudiants avec ABINJ
	pour voir s'ils ont un justificatif (une petite fenêtre apparaît).
      </li>
      <li>
	Finalement, la méthode la plus longue est d'aller dans
	le menu «ABJ par date» puis de sélectionner
	    la date pour voir la liste des étudiants ayant
	    une ABJ pour cette date.
      </li>
    </ul>
    </div>

    <div>
    <h3>Cas des grandes UE</h3>
    <p>
      La gestion des absences injustifiées n'est pas facile car&nbsp;:
    <ul>
      <li> il y a de nombreux groupes et donc enseignants.
      <li> de nombreux étudiants changent de groupe.
      <li> les absences justifiées ne sont pas connues à l'avance.
      <li> un enseignant (hors responsable d'UE ou du cours quand
	l'UE est composée de plusieurs cours) n'a pas le
	droit de modifier une information saisie par un autre.
    </ul>
    <div style="border:1px solid black;padding: 0.5em">
      <h4>Procédure simplifiée expérimentale</h4>
      <p>
	Dans le champ à droite de «Cellules modifiables si:»
	qui est dans l'onglet «Config» de chaque colonne, vous indiquez&nbsp;:
	<pre><b>= | @ | =ABINJ</b></pre>
      <p>
	N'importe quel enseignant pourra alors remplacer un ABINJ saisi
	par quelqu'un d'autre par autre chose.
    </div>
    <p>
      Voici la procédure à suivre pour ne pas avoir de problèmes&nbsp;:
    </p>
    <ul>
      <li> <b>Pour la séance courante</b>&nbsp;:
	<p>
	  L'enseignant saisit les présences et les notes.<br>
	  <em style="color:red">L'enseignant ne doit pas indiquer une absence injustifiée,
	    car en le faisant il empêche un autre enseignant de noter
	    l'étudiant présent dans un autre groupe.</em>
	<p>
	  Pour indiquer une présence il suffit de mettre un <tt>P</tt>
	  dans la cellule ou de double-cliquer dessus.

      <li> <b>Pour les séances précédentes</b>&nbsp;:
	<p>
	  L'enseignant responsable de l'UE ou du cours
	  parcourt les cellules vides et indique
	  les absences <b>justifiées</b>
	  en fonction de la date de la séance
	  et des justificatifs d'absences listés par TOMUSS.
	<p>
	  Pour indiquer une absence justifiée, il suffit de mettre <tt>J</tt>
	  ou <tt>ABJ</tT> dans la case.
    </ul>
    <p>
      Pour que les cases <b>restées vides</b> soient comptabilisées
      comme des ABI le responsable d'UE met <tt>ABINJ</tt>
      dans le champ «<tt>Si vide</tt>» de la colonne représentant la séance.
      Ce champ est dans l'onglet «Formule»

    </div>
    <div>
    <h4>Calculer le pourcentage d'ABJUS</h4>

    <p>
      Vous voulez connaître le pourcentage d'absence justifiée
      afin de savoir si une moyenne a toujours un sens :
      vous allez sur le triangle permettant de trier la colonne
      et vous cliquez pour trier par %ABJ.
      Cela compte les PPNOT comme des ABJUS
      <p>
	ATTENTION : ce pourcentage ne tient pas compte des colonnes
	qui ont un poids qui commence par + ou - car
	ce sont généralement des bonus ou malus.
      </div>
    

    <div>
    <h3>Les ABINJ???</h3>
    <p>
	  Des <tt>ABINJ???</tt> apparaissent dans le suivi des étudiants
	  qui n'ont pas eu de note alors que les 3/4 des étudiants
	  du même groupe ont eu une note.
    <p>
	  Si vous désirez que ces <tt>ABINJ???</tt> n'apparaissent pas
	  il suffit d'indiquer dans le champs «<tt>Si vide</tt>» de
	  la colonne qui vous intéresse un texte.
    <p>
          Par exemple : «Oral pas encore passé»
	  

      </div>
	

    <div>
    <h2>Destructions et effacements</h2>
	<p>
	  Il est presque impossible de perdre des informations
	  lorsque l'on utilise TOMUSS.
	<p>
	  La destruction de ligne est totalement impossible.
	  La destruction de colonne n'est possible que si
	  la colonne a été vidée.
    </div>

    <div>
    <h3>Vider une cellule</h3>

    <p>
	  Vous remplacez le contenu de la cellule par un texte vide
	  si vous voulez l'effacer.
    <p>
	  Une fois une cellule effacée les autres enseignants pourront
	  lui donner une nouvelle valeur.
    <p>
	  Les différentes valeurs prises par la cellule ainsi que
	  le nom de la personne qui a fait la modification sont
	  affichées dans l'historique de la cellule.
	  Les étudiants ne voient pas l'historique, seulement
	  la valeur actuelle de la cellule.
    </div>

    <div>
    <a name="remplir"> </a>
    <h3>Vider ou remplir une colonne</h3>

    <p>
        Voici comment procéder :
    <ul>
	  <li> 
	    <b>Le remplissage n'est pas réversible,
	      désactiver la sauvegarde automatique avant de le faire</b>.
          <li> Vous commencez par définir les lignes que vous voulez remplir
	    ou vider. Pour cela vous filtrez les lignes qui vous intéressent.
	    Si vous voulez tout remplir, ne filtrez rien.
	  <li> Vous vous mettez dans la bonne colonne en cliquant
	       sur une case.
	  <li> Dans l'onglet «Colonne/Action» cliquez sur
	  sur  «Remplir la colonne avec des valeurs».
	    Ceci fera apparaitre une fenêtre.
	</ul>
	Ensuite plusieurs choix sont possibles :
	<ul>
    <li>
	  Pour remplir toute la colonne avec la même valeur :
	  vous saisissez la valeur dans le champs de saisie actif.
    <li>
	  Pour vider la colonne : vous activez le bouton «Effacer»,
	  vous cochez la première ligne pour remplir avec rien.
    <li>
	  Pour remplir de manière équilibrée avec des valeurs différentes :
	  vous saisissez les valeurs ou vous cochez des valeurs existantes.
	  L'équilibrage tient compte de toutes les lignes,
	  si vous ne voulez pas, décochez «Equilibrage global».
	  Si vous voulez un remplissage ABABAB au lieu de AAABBB
	  cochez «Interclasser».
    <li>
          Pour remplir avec des nombres : utilisez «%%» dans le texte,
	  il sera remplacé par le nombre.
	  Les nombres possibles sont définis par la liste d'intervalles
	  indiquée à droite.
    </ul>
    <p>
      Quand cela vous semble bon, vous cliquez sur «Remplir»
    <p>
	  Remarques :
    <ul>
      <li> Par défaut le remplissage ne modifie pas les valeurs saisies,
	pour les modifier il faut cocher «Effacer».
      <li> Le remplissage est fait dans les lignes filtrées.
	Donc la table qui est visible sur l'écran.
      <li> Le remplissage est fait dans l'ordre des lignes
	sur l'écran.
    </ul>
    </div>
    <div>
    <a name="places_salle"> </a>
    <h4>Répartir les étudiants dans des salles</h4>
    <p>
      Voici comment procéder :
	<ul>
	  <li> Vous filtrez les étudiants ayant une mauvaise note.
	  <li> Vous triez par note.
	  <li> Vous remplissez avec les valeurs 'Soutien Salle 1'
	    et 'Soutien Salle 2'
	  <li> Vous choisissez le remplissage «ABC ABC ABC...» pour avoir
	    deux salles avec le même niveau moyen.
	    Ou bien le remplissage «AA... BB... CC...» pour avoir une
	    séparation par niveau dans les deux salles.
	</ul>	    

    </div>

    <div>
    <a name="places_numero"> </a>
    <h4>Placer les étudiants dans un Amphi</h4>

    <p>
        Voici comment procéder :
	<ul>
	  <li> Vous triez les étudiants par note en cliquant sur le titre
	    de la colonne (les plus basses en premier
	    pour qu'ils soient en bas de l'amphi)
	  <li> Vous filtrez l'amphi qui vous intéresse.
	  <li> Vous nommez une colonne «Place dans l'amphi»
	  <li> Vous cliquez sur l'onglet «Colonne/Action»
	  <li> Vous cliquez sur «Remplir la colonne avec des valeurs»
	  <li> Vous cliquez sur l'onglet «42 43 44 45...»
	  <li> Vous saisissez le premier numéro de place dans le champs
	    de saisi.
	  <li> Vous cliquez sur le bouton «valeur» en bas de la fenêtre
	    pour remplir la colonne.
	</ul>
    </div>

    <div>
    <h3>Détruire un tableau</h3>

    <p>
      Vous allez dans l'onglet «Action» du tableau.
      Il y a un lien pour le détruire.
    <p>
      Si le tableau a été détruit par erreur, demandez sa restauration
	à l'administrateur de TOMUSS.
    </div>

    <div>
    <h3>Détruire une colonne</h3>
	<p>
	  Pour éviter tout problème on ne peut pas détruire des colonnes
	  qui ne sont pas vide.
	<p>
	  Il faut donc d'abord vider la colonne.
	<p>
	  Ensuite il faut aller dans l'onglet «Colonne/Action»
	  et cliquer sur «<b>Détruire définitivement la colonne</b>»
	<p>
	  Aucune récupération n'est possible sans passer
	  par l'administrateur de TOMUSS.
      </div>
      

    <div>
    <h2>APOGÉE</h2>
	<p>
	  TOMUSS conserve et calcule les notes avec plus
	  de 3 chiffres après la virgule.
	  Il les affiche tronquées à 2 chiffres après la virgule.
	<p>
	  Pour éviter tout problèmes durant les jurys les notes
	  affichées par TOMUSS sont arrondies au centième inférieur.
	  Lors des exports vers APOGÉE, elles sont arrondies
	  au millième le plus proche.
	  TOMUSS ne vous dira pas que l'étudiant à 10.00 alors que
	  sa note réelle est 9.996

    </div>


    <div>
    <h3>Remplir le fichier de note APOGÉE</h3>

    <p>
      On utilise cette fonctionnalité pour remplir facilement
      le fichier que nous envoit l'administration
      pour la saisie des notes.
      Il y a une <a href="http://perso.univ-lyon1.fr/thierry.excoffier/TOMUSS/TUTORIALS/howto.html#apogee">version vidéo de ces explications</a>.

    <ul>
      <li> Vous cliquez sur une cellule de la colonne que vous voulez exporter
	vers APOGÉE.
      <li> Dans l'onglet «Colonne/Action»
           cliquez sur le lien «Exporter la colonne pour APOGEE»&nbsp;:
	une fenêtre apparaît.
      <li> Vous copiez la liste des numéros d'étudiants
	du tableau fourni par l'administration.
      <li> Vous la collez dans la zone de saisie blanche de la fenêtre.
      <li> Éventuellement vous cochez la case pour
	transformer les ABJ et les PPN en 0.
      <li> Vous copiez les notes affichées dans la zone centrale
	et les collez dans le tableau venant de l'administration.
	Elles sont dans le bon ordre&nbsp;!
      <li> Si des étudiants ont des notes dans TOMUSS mais pas
	dans APOGÉE vous êtes prévenu.
      <li> Si des étudiants sont dans APOGÉE mais que vous ne les notez pas,
	vous êtes prévenu.
    </ul>
    <p>
      La seule erreur possible est de faire un décalage de ligne
      lors du copier/coller. Vérifiez donc bien la première
      et la dernière.
    <p>
      Si jamais votre tableur est configuré en anglais, il faut
      le basculer en français pour ne pas avoir de problèmes
	  avec les virgules des nombres.

    </div>
    <div>
    <h4>La table APOGÉE contient déjà des notes et PrC</h4>

    <p>Voici une solution (elle prend moins de 2 minutes montre en main).
	<ul>
	  <li> Vous désactivez la sauvegarde automatique
	    car vous ne voulez rien sauvegarder.

	  <li> Vous "créez" une colonne de type texte (à cause des PrC).

	  <li> Vous importez dans cette colonne le tableau APOGÉE
	    avec les notes déjà acquises (la colonne sera presque vide).
	    
	  <li> Il faut ensuite recopier vos nouvelles notes dans cette colonne,
	    en faisant ceci :

	    <ul>
	      <li> Vous filtrez les lignes qui sont vides (vous mettez le
		symbole <b>=</b> dans le filtre de la nouvelle colonne)

	      <li> Vous cliquez sur 'les filtrés' pour
		avoir tous les numéros d'étudiant affichés.

	      <li> Vous cliquez sur 'N° d'étudiant'
		
	      <li> Vous faites un copié des valeurs affichées et vous vous 
		en servez pour importer les notes dans la nouvelle colonne.
		Cela n'écrasera pas les notes APOGÉE.
	    </ul>

	    <li> Vous avez toutes les bonnes valeurs dans la nouvelle colonne
	    et vous pouvez donc l'importer dans le fichier APOGÉE.
	</ul>
	<p>
	Vous vérifiez bien sûr que les cases grises contiennent PrC pour
	vérifier que tout est Ok. 


    </div>

    <div>
    <h3>Classer les étudiants par formation</h3>

    <p>
      Vous utilisez le type «<b>Code Étape</b>»
	  et vous indiquez «ID» comme nom de colonne contenant
	  les numéros d'étudiants.
      La colonne se remplira de (ou des) étapes d'inscription des étudiants.

    </div>


    <div>
    <h2>Import et Export</h2>
    <p>
	  L'<a href="javascript:go('Remplir le fichier de note APOGÉE')">exportation
	    vers APOGÉE</a> a déjà été décrite.
	  Elle peut être utilisée pour extraire seulement
	  une colonne de TOMUSS.
    </div>

    <div>
    <h3>Importation de colonne</h3>

    <p>
      Si vous avez un fichier dans un tableur qui contient
      les étudiants et des notes
      vous pouvez importer <b>une</b> colonne de votre
      tableau dans TOMUSS.
    <ul>
      <li> Vous cliquez sur une cellule de la colonne dans
	laquelle vous voulez importer des valeurs.
	<li> Vous allez dans l'onglet «Colonne/Action»
      <li> vous choisissez «Importer des valeurs dans la colonne».
	Une fenêtre apparaît.
      <li> Vous faites un copié dans votre tableur des cases contenant
	le <b>numéro d'étudiant</b> et la <b>note</b>.
      <li> Vous faites le collé dans TOMUSS dans la fenêtre de saisie.
      <li> Vous cliquez sur «Importer les données».
	En cas de problème des fenêtres explicatives apparaîtront.
    </ul>
    <p>
      Avant de détruire des données existantes,
      on vous demandera une confirmation.
    <p>
      Pour recopier une colonne dans une autre il suffit de faire
      un export suivi d'un import en recopiant les données avec
      un copier/coller.
    <p>
      Pour importer des retours à la ligne, vous pouvez utiliser
      le symbole ⏎, il sera remplacé par un retour à la ligne.
    <p>
      Il est possible de recopier dynamiquement une colonne dans une autre.
      Si la colonne originale est modifiée alors la copie est modifiée
      <b>sauf les cellules que vous avez modifiées dans la copie</b>.
      Ceci est pratique quand le jury veut modifier une moyenne sans
      vouloir indiquer des points jury.
      Pour faire une copie dynamique il faut utiliser le type
	  de colonne «Copy On Write».
    </div>

    <div>
    <h3>Extraire dynamiquement colonne</h3>

    <p>
      Vous disposez d'informations sur les étudiants
      dans une adresse web du genre&nbsp;:
      <tt>http://www.univ-lyon1.fr/MesNotes/MonUE.csv</tt>
    <p>
      Le format du fichier CSV :
    <ul>
      <li> La première colonne de ce fichier contient des numéros d'étudiant.
      <li> Le séparateur de colonne est le premier trouvé parmi :
           la tabulation, le point-virgule, la virgule.
      <li> L'encodage des caractères du fichier est soit UTF-8,
           soit latin1 (ISO8859-1).
    </ul>
    <p>
      Vous pouvez dire à TOMUSS de prendre le contenu d'une colonne
      de ce tableau et de le mettre dans une de ses colonnes.
      Si par exemple vous voulez extraire la cinquième colonne
      du fichier CSV, vous indiquez dans le champs approprié
      de l'onglet <tt>Config</tt>&nbsp;:
    <pre>http://www.univ-lyon1.fr/MesNotes/MonUE.csv#5</pre>
    <p>
      L'URL ne sera pas visible par les étudiants,
      mais elle sera visible par les autres enseignants.
      Les étudiants verront le reste du commentaire.
    <p>
      TOMUSS relira le contenu du fichier pour l'importer,
      chaque fois que vous irez sur la table ou bien que vous forcerez
      sa mise à jour.
    <p>
      Attention, TOMUSS :
      <ul>
      <li> écrasera les informations existante dans les cellules,
      <li> ne vérifiera pas si les informations importées sont correctes,
      <li> gardera l'historique des changements,
      <li> ne vous permettra pas de modifier les notes importées.
    </ul>


    </div>
    <div>
      <h4>Extraire une colonne d'une autre table TOMUSS</h4>
    <p>
      Cela se fait exactement de la même façon que pour extraire
      une colonne d'un fichier CSV sur le web.
      L'URL à indiquer aura une des formes suivantes&nbsp;:
      <ul>
	<li> nom_de_table/nom_de_colonne
	<li> semestre/nom_de_table/nom_de_colonne
	<li> année/semestre/nom_de_table/nom_de_colonne
      </ul>
      <p>
	On peut donc facilement récupérer des notes d'un semestre
	précédent pour les reporter dans le semestre courant.
      <p>
	
	L'importation est faite quand la table est visitée, on peut
	la forcer en cliquant sur le 'Forcer la mise à jour' dans
	l'onglet 'Action' du bloc 'Table'.
      
    </div>

    <div>
    <h3>Copier la table TOMUSS complète dans Excel (exporter vers Excel)</h3>
	<p>
	  Vous cliquez dans «Imprime»
	  puis vous suivez les instructions (il suffit de faire
	  un copier/coller).
	<p>
	  <span style="color:red">N'utilisez pas cette procédure
	    pour copier une colonne</span>
	  de notes dans en fichier Excel.
	  Utilisez <a href="javascript:go('exporter')">
	    l'exportation de colonne</a>
      </div>

    <div>
    <h3>Extraction d'information</h3>
<ul>
      <li> <b>Pour avoir un résumé de plusieurs UE</b> :
	Cela affiche l'ensemble des étudiants des UE en indiquant
	le nombre de cellules saisies pour chaque étudiant.
	Les UE doivent toutes faire partie du semestre indiqué dans l'URL.
	<br>
	<tt><b>http://tomusss.univ-lyon1.fr/2008/Automne/resume/UE-MAT1001L/UE-MAT1002L/UE-INF1001L/UE-TVL1001L/UE-PHY1002L</b></tt>
      </li>
	
      <li> <p><b>Pour extraire des colonnes de plusieurs UE</b> :
	Cela affiche l'ensemble des étudiants des UE en indiquant
	les valeurs contenues dans les différentes UE pour
	chacun des noms de colonne indiqués.
	Les UE doivent toutes faire parties du semestre indiqué dans l'URL.
	<br>
	<tt><b>http://tomusss.univ-lyon1.fr/2008/Automne/extract/UE-MAT1001L:APO_CC:APO_CT/UE-INF1001L:APO_CC:APO_CT:APO_CT2</b></tt><br>

      <li> <p><b>Pour fusionner des colonnes de plusieurs UE</b> :
	<p>
	    C'est comme l'extraction, mais cela ne génère pas une
	      colonne par UE.
	      Chaque case contient le nom de l'UE, de la colonne et
	      la note de l'étudiant.
	      Les cases vides ne contenant pas de notes ne sont
	      pas indiquées.
	<br>
	<tt><b>http://tomusss.univ-lyon1.fr/2008/Automne/fusion/UE-MAT1001L:APO_CC:APO_CT/UE-INF1001L:APO_CC:APO_CT:APO_CT2</b></tt>

      <li> <p><b>Compter le nombre de valeurs de cellules dans plusieurs UE en classant par date d'enseignement.</b> :
	Cela affiche l'ensemble des étudiants des UE en indiquant
	le nombre de cellules dont la valeur est celle recherchée
        en les classant par date d'enseignement.
	<br>
	<tt><b>http://tomusss.univ-lyon1.fr/2008/Automne/count/ABINJ/UE-MAT1001L/UE-MAT1002L/UE-INF1001L/UE-TVL1001L/UE-PHY1002L</b></tt>
	    <br>
	    L'URL précédente permet de compter le nombre d'ABINJ des
	    étudiants par semaine.
	    Il faut bien sûr que les dates des enseignements aient été
	    saisie pour chacune des colonnes pouvant contenir un ABINJ.
      </li>
</ul>
</div>

    <div>
    <h2>Gestion des semestres</h2>
    <p>
	  TOMUSS est semestrialisé.
    </div>

    <div>
    <a name="extension"> </a>
    <h3>UE à cheval sur 2 semestres</h3>

    <p>
      Quand un semestre est terminé les tables sont basculées
      en lecture seulement pour éviter tout problèmes. 
    <p>
      Si l'UE dure toute l'année après avoir commencé à l'automne,
      il n'est plus possible de la modifier une fois au printemps.
    <p>
      Pour pouvoir continuer à la modifier au printemps :
      il vous suffit de cliquer sur le '+' sur la ligne de l'UE
      sur la page d'accueil de TOMUSS et de choisir
	  «Passer cette UE en non-semestrialisé»
    <p>
      Votre tableau est alors sur les 2 semestres,
      quand vous modifiez la version du printemps,
      la version de l'automne est automatiquement mise à jour.
     <p>
      <b>N'utilisez pas cette procédure si l'UE est répétée sur les deux
      semestres.</b>

    </div>
    <div>
    <h3>Conservation des notes CC</h3>

    <p>
      Après avoir fait les calculs pour obtenir 
      la note finale de CC il reste le problème
      des étudiants ayant NaN ou ABJUS car ils
      conservent leur note de CC du semestre précédent.
    <p>
      On ne peut pas modifier le résultat d'un calcul.
    <p>
      Voici une solution simple (il y en a d'autres)&nbsp;:
    <ol>
      <li> Vous créez une colonne «CC_Conservé»
      <li> Vous faites un <em>import</em> dans cette colonne
	avec les résultats de CC conservés.
	TOMUSS protestera à propos des étudiants qui ne se sont pas
	réinscrits car il ne les trouve pas.
      <li> Vous faites une colonne de type «Maximum»
	    entre la note de CC du semestre
	courant et celle conservée.
      <li> Si une note ne doit pas être conservée,
	vous mettez 0 dans la bonne cellule de «CC_Conservé»
	    ou en laissant la case vide et en indiquant la valeur «0»
	    comme valeur par défaut pour les cases vides de la colonne.
    </ol>

    Au final, vous devriez avoir&nbsp;:
    <ul>
      <li> «CC» : La moyenne donnant la note de CC du semestre courant
      <li> «CC_Conservé» : La note obtenue au semestre précédent.
      <li> «CC_Avant_Jury» : Maximum de «CC» et «CC_Conservé»
    </ul>
    </div>

    <div>    
    <h3>Recopier toutes les colonnes</h3>
	<p>
	Refaire la définition de toutes les colonnes dans une table
	  vide pour faire les mêmes que celles du semestre précédent
	  n'est pas très productif.
	  </p>
	<p>Pour faire une recopie sans rien changer, alors
	  faites une recopie de table (Onglet «Table/Action», «Copie de table TOMUSS»)</p>

	<p>Pour faire une copie en faisant des changements :
	  </p>
<ul>
    <li><p>
      Onglet «Table/Action», Cliquez sur le lien «Exporter»
    <li><p>
      Copiez la liste des colonnes.
    <li><p>
       Dans la table destination des colonnes,
       Onglet «Table/Action», cliquez sur le lien «Importer»
      et copiez la liste des colonnes.
    <li><p>
      Vous pouvez modifier la liste des colonnes avant de
      l'importer dans TOMUSS.
    <li><p>
      Si vous n'êtes pas certain du résultat vous pouvez désactiver
      la sauvegarde automatique pour vérifier avant de sauvegarder.
	    </ul>
    </div>

    <div>
    <h3>Éléments constitutifs (ECUE)</h3>
    <ul>
      <li><p> Si vous voulez plusieurs tables différentes
	  avec les mêmes étudiants (pour des UE avec des composantes).
	  Alors ajoutez <b>-1</b>, <b>-2</b>, <b>-3</b>...
	  à la fin du nom de l'UE dans l'URL.
	  ATTENTION : on ne peut pas faire de calcul
	  mélangeant les valeurs des différentes tables.
      </li>
    </ul>
    </div>

    <div>
    <h3>Créer une table vierge</h3>
    <p>Il est possible de créer une nouvelle table vide et
	  d'y mettre les étudiants que vous voulez.
	  Pour cela, il suffit simplement d'indiquer l'adresse
	  de la table dans votre navigateur web pour la créer.
	  <tt>http://tomuss....../Annee/Semestre/Table</tt>
    </p>
    <p>L'année est indiquée avec 4 chiffres, le nom de la table ou du semestre
      ne doit pas contenir d'espace ou d'accents.
    </p>
    <p>Voici quelques consignes concernant le semestre :
    <ul>
      <li><p> Si la table contient des étudiants, alors le semestre 
	      est impérativement <tt>Automne</tt> ou <tt>Printemps</tt>.
	      Les tables qui ne sont pas dans ces semestres
	      ne contiennent aucune colonne prédéfinie.
            </p></li>
      <li><p> Si vous voulez que la table ne soit visible que par
	      les personnes indiquées comme responsable de la table
	      alors il convient de mettre <tt>Dossiers</tt> pour
	      le semestre.
	    </p></li>
      <li><p> Si la table peut être vue par tous le monde,
	      alors il convient de mettre <tt>Public</tt> pour
	      le semestre.
	    </p></li>
    </ul>
    <p>Une fois la table affichée, il faut :
      <ul>
	<li><p> Mettre un commentaire de table pour que les étudiants
	    comprennent de quoi il s'agit.
	<li><p> Vérifier si la table est visible ou non par les étudiants
	  en allant dans l'onglet «Table / Paramétrage».
	    Les étudiants ne voient que la ligne les concernant.
	<li><p> Vous ajouter vous même dans la liste des responsables
	  de la table.
	  Cela la fera apparaître sur votre page d'accueil TOMUSS.
	<li><p> Pour remplir la liste des étudiants :
	  <ul>
	    <li> vous allez sur une cellule de la première colonne ;
	    <li> puis dans l'onglet «Colonne / Action» ;
	    <li> vous cliquez sur «Importer des valeurs...» ;
	    <li> vous copiez les numéros d'étudiants dans le champs de saisie
	      (un par ligne) ;
	    <li> vous cliquez sur «importer les données dans TOMUSS»
	  </ul>
	  <p>
	    Vous attendez un moment pour que l'importation se termine,
	    cela peut être long...
	    Les noms et prénoms des étudiants apparaissent progressivement.
      </ul>
    <p>
      Si c'est une table d'étudiants, vous pouvez ensuite créer
      des colonnes de type «Référent», «Code etape», «Sportif»
      pour avoir des informations les concernant.
      
    </div>


    <div>
      <a name="filtres"> </a>
      <h2>Les filtres de TOMUSS</h2>

    <p>
      Ils sont utilisés en de nombreux endroits de la même manière :
      <table>
	<tr><th>Pour faire quoi<th>Où sont les filtres</tr>
      <tr>
	<td> Filtrer les lignes dont l'une des cellules
	  correspond au filtre.
	<td> En bas du bloc de gauche «Cellule».
	  Accès direct par <tt>Ctrl-f</tt>
      </tr>
      <tr>
	<td> Filtrer les lignes dont la cellule de
	  la colonne correspond au filtre de la colonne.
	<td> En dessous des titres de colonnes.</tr>
      <tr>
	<td> Filtrer les colonnes à afficher en fonction de leur nom.
	<td> En bas du bloc central «Colonne».</tr>
      <tr>
	<td> Filtrer la table complète pour éliminer
	  les lignes et colonnes ne contenant pas l'information filtrée.
	<td> En bas du bloc de droite «Table».</tr>
      <tr>
	<td> <b>Compter</b> le nombre de cellule correspondant au filtre.
	<td> A droite du type de colonne quand celui-ci est
	  <tt>Nombre de</tt></tr>
      <tr>
	<td> <b>Colorier</b> en rouge/vert les cellules d'une colonne.
	<td> Dans l'onglet «Affiche» du bloc central «Colonne»</tr>
      <tr>
	<td> <b>Droit d'accès</b> des cellules d'une colonne.
	<td> Dans l'onglet «Config» du bloc central «Colonne»</tr>
    </table>
	<p>
	  N'oubliez pas que toutes les actions sur la table
	  tiendront compte des filtres&nbsp;:
	  trombinoscope, émargement, mail, import, export, moyenne...
    </div>    
    <div>
    <h3>Exemples de filtres</h3>
	<p>
	  Seul les premiers vous seront utiles.
	<table>
      <tr class="highlight"><td> <b>e</b><td> la valeur commence par <tt>e</tt>, <tt>E</tt>, <tt>é</tt>, <tt>è</tt>, <tt>É</tt>, <tt>È</tt>...</tr>
      <tr><td> <b>jean</b><td> la valeur commence par <tt>jean</tt></tr>
      <tr class="highlight"><td> <b>=jean</b><td> la valeur est exactement <tt>jean</tt></tr>
      <tr><td> <b>~jean</b><td> la valeur contient <tt>jean</tt></tr>
      <tr class="highlight"><td> <b>=</b><td> la valeur est vide (égale à rien).</tr>
      <tr><td> <b>&gt;5</b><td> la valeur est strictement supérieure à 5.</tr>
      <tr class="highlight"><td> <b>&gt;5 &lt;15</b><td> Les nombres entre 5 et 15 exclus.</tr>
      <tr><td> <b>&lt;=5 ou &gt;15</b><td> Les nombres inférieurs à 5 ou supérieurs à 15.</tr>
      <tr class="highlight"><td> <b>#</b><td> La valeur a un commentaire (<b>!#=</b>).</tr>
      <tr><td> <b>?</b><td> La valeur a été modifiée aujourd'hui (<b>?=JJ/MM/YYYY</b>).</tr>
      <tr class="highlight"><td> <b>@</b><td> La valeur a été modifiée par vous même (<b>@=prenom.nom</b>).</tr>
      <tr><td> <b>:</b><td> La valeur a un historique, elle a été changée plusieurs fois (<b>!:=</b>).</tr>
      <tr class="highlight"><td> <b>&lt;1/3/2008</b><td> la valeur est une date antérieure au 1 Mars 2008.</tr>
      <tr><td> <b>@=jacques.martin</b><td> la personne qui a modifié la cellule est <tt>jacques.martin</tt></tr>
      <tr class="highlight"><td> <b>#ok</b><td> le commentaire commence par <tt>ok</tt></tr>
      <tr><td> <b>#~ok</b><td> le commentaire contient <tt>ok</tt></tr>
      <tr class="highlight"><td> <b>?&gt;1/3/2008</b><td> la valeur a été modifiée après le 1 Mars 2008.</tr>
      <tr><td> <b>?&lt;8j</b><td> la valeur a été modifiée il y a moins de 8 jours.</tr>
      <tr class="highlight"><td> <b>?&lt;2s ?&gt;3h</b><td> la valeur a été modifiée il y a moins de 2 semaines et plus de 3 heures.</tr>
      <tr><td> <b>?~2008</b><td> la valeur a été modifiée en 2008 (la date contient 2008)</tr>
      <tr class="highlight"><td> <b>:~ABINJ</b><td> la valeur a contenu <tt>ABINJ</tt> dans le passé.</tr>
      <tr><td> <b>!=</b><td> la valeur n'est pas vide.</tr>
      <tr class="highlight"><td> <b>!#=</b><td> le commentaire n'est pas vide.</tr>
      <tr><td> <b>ab ou ba</b><td> La valeur commence par <tt>ab</tt> ou <tt>ba</tt></tr>
      <tr class="highlight"><td> <b>~abc ~cba</b><td> La valeur contient <tt>abc</tt> et aussi <tt>cba</tt></tr>
      <tr><td> <b>&gt;=b &lt;=h</b><td> Les valeurs commençant par un caractère entre 'b' et 'h'.</tr>
      <tr class="highlight"><td> <b>@ ?</b><td> Les valeurs que j'ai modifiées aujourd'hui.</tr>
      <tr><td> <b>!@ ?</b><td> Les valeurs modifiées par les autres aujourd'hui.</tr>
      <tr class="highlight"><td> <b>=0 ou =ABINJ ou =PPNOT</b><td> L'une des trois valeurs</tr>
      <tr><td> <b>[Seq]=5</b><td> La valeur dans colonne <tt>Seq</tt> est égale à 5</tr>
      <tr class="highlight"><td> <b>[Grp]A</b><td> La valeur dans colonne <tt>Grp</tt> commence par A</tr>
      <tr><td> <b>[TD2]&gt;[TD1]</b><td> La note de TD2 est supérieure à celle de TD1</tr>
      <tr class="highlight"><td> <b>?[]&lt;30/01/2015-11:45</b><td> La date actuelle est avant la date indiquée</tr>
      <tr><td> <b>@[]=[EnseignantTP]</b><td> La personne connecté à son login indiqué dans la colonne EnseignantTP</tr>
      <tr class="highlight"><td> <b>#[TD3]~A</b><td> Le commentaire dans la colonne <tt>TD3</tt> contient A</tr>
</table>


    </div>    
    <div>    
    <h3>Filtre simple</h3>
	<p>
	  Si vous n'êtes pas informaticien, ne lisez pas ceci.
    <p>
      Un filtre simple est la concaténation de 4 informations.
	<ul>
	  <li> La négation inverse la signification du filtre
	    qui est juste derrière.
	    Elle est indiquée en commençant le filtre
	    par «<b>!</b>»
	  <li>
	    Par défaut, on teste le contenu de la cellule,
	    mais si l'on ajoute un caractère particulier, on
	    peut vérifier d'autres attributs de la cellule&nbsp;:
	    <ul>
	       <li>«<b>?</b>» : la date de modification
	       <li>«<b>@</b>» : le nom de la personne qui a saisi en dernier
	       <li>«<b>:</b>» : les anciennes valeurs
	       <li>«<b>#</b>» : le commentaire associé
	    </ul>
	  <li>
	    Par défaut, on teste si la valeur <em>V</em> commence
	    par les caractères indiqués.
	    Sauf si ce qui suit est&nbsp;:
            <ul>
	       <li>«<b>~</b>» : <em>V</em> contient <em>C</em><br>
	       <li><em>V</em> «<b>&lt;</b>» <em>C</em><br>
	       <li><em>V</em> «<b>&lt;=</b>» <em>C</em><br>
	       <li><em>V</em> «<b>&gt;</b>» <em>C</em><br>
	       <li><em>V</em> «<b>&gt;=</b>» <em>C</em><br>
	       <li><em>V</em> «<b>=</b>» <em>C</em><br>
          
	  </ul>
	  <li>
            La valeur à tester peut être&nbsp;:
	    <ul>
	      <li> une chaine vide.<br>
	      <li><b>123.456</b> Si c'est un nombre, alors les tests seront numériques
		et donc '5' sera bien égal à '5.0'<br>
	      <li><b>abcde</b> Si c'est une chaine, alors les opérateurs
		seront lexicographiques et ne feront pas la différence
		entre les minuscules et les majuscules.
		Sauf si la chaine contient des majuscules ou des accents.
	      <li><b>[TitreDeColonne]</b> le contenu de la colonne indiquée.
		On peut ajouter <b>?@:#</b> avant le crochet pour prendre
		un autre attribut.
	      <li> <b>JJ/MM/AAAA</b> Pour comparer des dates.
	      <li> <b>99h</b> Il y a 99 heures.
	      <li> <b>99j</b> Il y a 99 jours.
	    </ul>
	</ul>


    </div>    
    <div>    
    <h3>Filtre complexe</h3>
	<p>
      Un filtre complexe est une combinaison de filtres simples :
      <ul>
      <li> Si on veut faire un «ou» on écrit simplement <b>&nbsp;ou&nbsp;</b>
	entre les tests simples,
      <li> Si on veut faire un «et» on écrit simplement
	les tests simples en les séparant par un espace.
      <li>Les «et» sont prioritaires sur les «ou»
    </ul>

    <ul>
      <li> <b>&gt;5 &lt;7 ou &gt;15 &lt;17</b>
	interprété comme : (&gt;5 &lt;7) ou (&gt;15 &lt;17)<br>
    </ul>
    <p>
      Pour utiliser un caractère spécial dans le filtre,
      il faut le précéder de <b>\</b> juste avant.
      Par exemple, <b>\~</b> recherche un tilde en premier caractère.
</div>
    <div>
    <h2>Divers</h2>
    <p>
      Les informations inclassables.
    </div>
    <div>
    <h3>Moteur de recherche TOMUSS</h3>
    <p>
      On peut directement intégrer le moteur de recherche TOMUSS
      dans la barre d'adresse du navigateur web.
      Vous pouvez alors rechercher des étudiants, enseignants et
      UE directement avec la barre d'adresse sans avoir besoin
      d'aller sur TOMUSS.
    <p>
      Voici comment configurer votre navigateur :
      <table class="colore">
	<colgroup><col width="50%"><col width="50%"></colgroup>
	<tr><th>FireFox<th>Chrome</tr>
	<tr><td colspan="2" style="text-align: center">
	    Allez sur la page d'accueil de TOMUSS</tr>
	<tr>
	  <td>
	    <p>
	      Cliquer sur l'icone du moteur de recherche qui est à droite
	      de la barre d'adresse.
	    <p>
	      Choisir «Ajouter TOMUSS» dans le menu.
	    <p>
	      Remettre Google comme moteur de recherche
	      par défaut (sinon cela sera TOMUSS)
	    <p>
	      Cliquer à nouveau sur l'icône du moteur de recherche.
	  </td>
	  <td>
	    <p>
	      Cliquer avec le bouton droit sur la barre d'adresse.
	  </td>
	  </tr>
	<tr>
	  <td colspan="2" style="text-align: center">
	    <p>
	      Choisir «Gérer les moteurs de recherche» dans le menu
	  </td>
	</tr>
	<tr>
	  <td>
	    <p>
	      Cliquer sur «TOMUSS» et puis «Modifier le mot-clé»
	  </td>
	  <td>
	    <p>
	      Cliquer sur le champs de saisie du milieu
	      sur la ligne concernant TOMUSS.
	  </td>
	</tr>
	<tr><td colspan="2" style="text-align: center">
	    Indiquer «t» comme mot-clé et fermer les fenêtres.
	</tr>
	<tr><td colspan="2" style="text-align: center">
	    Dans la barre d'adresse taper «t eliane» par exemple
	    au lieu d'une URL.
	</tr>
      </table>
    </div>
    <div>
    <h3>Binôme, trinôme, groupes</h3>
    <p>
      Un groupe contenant 2 personnes est un binôme.
    </p>
    <p>
      Pour saisir une seule fois la valeur pour tous les
      étudiants d'un groupe,
      il faut tout d'abord avoir une colonne contenant
      le nom ou le numéro du groupe pour chaque étudiant.
    </p>
    <p>
      Ensuite, dans la colonne dans laquelle on veut faire
      la saisie des valeurs on doit indiquer que les valeurs
      saisies doivent êtres recopiée pour les autres membres du groupe :
    </p>
    <ul>
      <li> On va dans la colonne ou l'on veut saisir les notes.
      <li> On va dans l'onglet «Formule».
      <li> Dans dans la case «Groupe» le titre de la colonne
	contenant les noms des groupes.
    </ul>
    <p>
      Comme cette configuration est faite colonne par colonne,
      on peut avoir plusieurs groupes différents TD, TP, projet...
    </p>
    </div>
    </div>
    <script src="documentation.js"></script>
  </body>
</html>
